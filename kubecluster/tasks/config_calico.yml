---
- name: Install and Configure Calico CNI  STEP1
  become: false
  ansible.builtin.copy:  
    src: tigera-operator.yaml
    dest: /tmp/

- name: Install CNI config file STEP1
  become: false
  ansible.builtin.shell:  kubectl create -f /root/tigera-operator.yaml
  register: cni_step1


- name: Debug CALICO Step1 
  ansible.builtin.debug:
    var: cni_step1


- name: Copy Custom CNI config file to master node
  become: false
  ansible.builtin.copy:
    src: custom-cni.yml.j2
    dest: /tmp/
    

- name: Install and Configure Calico CNI  STEP2
  become: false
  ansible.builtin.shell: kubectl create -f /tmp/custom-cni.yml
  register: cni_step2

- name: Debug CALICO Step2 
  ansible.builtin.debug:
    var: cni_step2

